import {promises as fs} from 'fs';
import ora from 'ora';
import path from 'path';
import {capitalize} from '../../helpers/string';
import {generateFile} from '../../helpers/template';

/**
 * Create a new component file for React with preset
 *
 * @param {string} name
 * @return {Promise<void>}
 */
export default async function makeComponent(name: string) {
  const spinner = ora().start();
  spinner.start(`Generating component: ${name}`);
  const cwd = process.cwd();

  await fs.mkdir(`${cwd}/packages/assets/src/components/${capitalize(name)}`, {
    recursive: true
  });
  await generateFile(
    'component/component',
    {
      name: capitalize(name)
    },
    path.resolve(
      cwd,
      `src/assets/components/${capitalize(name)}/${capitalize(name)}.js`
    )
  );
  await generateFile(
    'component/index',
    {
      name: capitalize(name)
    },
    path.resolve(
      cwd,
      `packages/assets/src/components/${capitalize(name)}/index.js`
    )
  );
  spinner.succeed(`Congratulations! Generate component: ${name} successfully`);
}
